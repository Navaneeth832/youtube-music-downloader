<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Navan YT Downloader</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="min-h-screen bg-slate-950 text-slate-100 selection:bg-cyan-500/30">

<!-- Background glow -->
<div class="fixed inset-0 -z-10 pointer-events-none">
  <div class="absolute -top-24 -left-24 w-96 h-96 bg-cyan-600/10 blur-[120px] rounded-full"></div>
  <div class="absolute -bottom-24 -right-24 w-96 h-96 bg-purple-600/10 blur-[120px] rounded-full"></div>
</div>

<!-- Navbar -->
<nav class="border-b border-slate-800/50 backdrop-blur-md sticky top-0 z-50">
  <div class="max-w-5xl mx-auto px-6 h-16 flex items-center justify-between">
    <h1 class="text-xl font-bold">
      â¬‡ï¸ Navan <span class="text-cyan-400">YT</span> Downloader
    </h1>
    <div class="flex gap-2">
      <button onclick="showTab('download')" id="tab-download"
        class="px-4 py-2 rounded-full bg-slate-800 text-cyan-400 text-sm font-medium">
        Downloader
      </button>
      <button onclick="showTab('library')" id="tab-library"
        class="px-4 py-2 rounded-full text-slate-400 text-sm font-medium hover:text-white">
        Library
      </button>
    </div>
  </div>
</nav>

<main class="max-w-3xl mx-auto px-6 py-12 space-y-10">

<!-- ================= DOWNLOAD TAB ================= -->
<section id="download-tab" class="space-y-10">

  <div class="text-center space-y-2">
    <h2 class="text-4xl font-extrabold">
      Grab <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-blue-500">YouTube Content</span>
    </h2>
    <p class="text-slate-400 text-lg">Paste link â†’ Click â†’ Terminal magic ğŸ§</p>
  </div>

  <div class="bg-slate-900/50 border border-slate-800 p-8 rounded-3xl shadow-2xl space-y-6">

    <div>
      <label class="text-sm font-semibold text-slate-400 ml-1">YouTube URL</label>
      <input id="url" type="text"
        placeholder="https://www.youtube.com/watch?v=..."
        class="w-full mt-2 bg-slate-950 border border-slate-700 rounded-2xl py-4 px-4 focus:outline-none focus:ring-2 focus:ring-cyan-500/50"/>
    </div>

    <div>
      <label class="text-sm font-semibold text-slate-400 ml-1">Format</label>
      <div class="flex gap-2 mt-2">
        <button onclick="setType('audio')" id="audioBtn"
          class="flex-1 py-3 rounded-xl bg-slate-800 text-cyan-400 font-semibold">ğŸµ Audio</button>
        <button onclick="setType('video')" id="videoBtn"
          class="flex-1 py-3 rounded-xl bg-slate-950 text-slate-400 border border-slate-700">ğŸ¥ Video</button>
      </div>
    </div>

    <div>
      <label class="text-sm font-semibold text-slate-400 ml-1">Quality</label>
      <select id="quality"
        class="w-full mt-2 bg-slate-950 border border-slate-700 rounded-2xl py-3 px-4">
        <option value="128k">128k (Fast)</option>
        <option value="192k">192k</option>
        <option value="320k">320k</option>
      </select>
    </div>

    <button onclick="startDownload()"
      class="w-full bg-gradient-to-r from-cyan-500 to-blue-600 py-4 rounded-2xl font-bold hover:opacity-90 active:scale-95 transition">
      ğŸ’¾ Start Download
    </button>

    <div id="status" class="hidden p-4 rounded-2xl text-sm"></div>
  </div>
</section>

<!-- ================= LIBRARY TAB ================= -->
<section id="library-tab" class="hidden space-y-6">

  <div class="flex items-center justify-between">
    <h2 class="text-2xl font-bold">ğŸ“ Download Library</h2>
    <button onclick="loadLibrary()"
      class="text-slate-400 hover:text-white text-sm">ğŸ”„ Refresh</button>
  </div>

  <div id="library-list" class="grid gap-4"></div>

  <div id="library-empty"
    class="hidden p-12 border border-dashed border-slate-800 rounded-3xl text-center text-slate-500">
    Folder empty. Download something first ğŸ“‚
  </div>

</section>

</main>

<footer class="text-center text-slate-600 text-sm py-10">
  Flask backend â€¢ Linux ğŸ§
</footer>

<script>
const API_BASE = "http://172.21.251.136:8000";
let type = "audio";

function showTab(tab) {
  document.getElementById("download-tab").classList.toggle("hidden", tab !== "download");
  document.getElementById("library-tab").classList.toggle("hidden", tab !== "library");

  document.getElementById("tab-download").className =
    tab === "download"
      ? "px-4 py-2 rounded-full bg-slate-800 text-cyan-400 text-sm font-medium"
      : "px-4 py-2 rounded-full text-slate-400 text-sm font-medium hover:text-white";

  document.getElementById("tab-library").className =
    tab === "library"
      ? "px-4 py-2 rounded-full bg-slate-800 text-cyan-400 text-sm font-medium"
      : "px-4 py-2 rounded-full text-slate-400 text-sm font-medium hover:text-white";

  if (tab === "library") loadLibrary();
}

function setType(t) {
  type = t;
  document.getElementById("audioBtn").classList.toggle("bg-slate-800", t === "audio");
  document.getElementById("videoBtn").classList.toggle("bg-slate-800", t === "video");
}

async function startDownload() {
  const url = document.getElementById("url").value;
  const quality = document.getElementById("quality").value;
  const status = document.getElementById("status");

  status.classList.remove("hidden");
  status.className = "p-4 rounded-2xl bg-cyan-500/10 text-cyan-400";
  status.innerText = "ğŸ“¡ Sending request to server...";

  try {
    const res = await fetch(API_BASE + "/download", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ url, type, quality })
    });

    if (!res.ok) throw new Error();
    status.className = "p-4 rounded-2xl bg-emerald-500/10 text-emerald-400";
    status.innerText = "âœ… Download started! Check terminal.";
  } catch {
    status.className = "p-4 rounded-2xl bg-rose-500/10 text-rose-400";
    status.innerText = "âŒ Server not reachable.";
  }
}

async function loadLibrary() {
  const list = document.getElementById("library-list");
  const empty = document.getElementById("library-empty");

  list.innerHTML = "";
  empty.classList.add("hidden");

  try {
    const res = await fetch(API_BASE + "/files");
    const files = await res.json();

    if (!files.length) {
      empty.classList.remove("hidden");
      return;
    }

    files.forEach(f => {
      const div = document.createElement("div");
      div.className = "bg-slate-900/50 border border-slate-800 p-4 rounded-2xl flex justify-between items-center";
      div.innerHTML = `
        <div class="truncate">
          <p class="font-semibold">${f.name}</p>
          <p class="text-xs text-slate-500">${f.size}</p>
        </div>
        <a href="${API_BASE}/files/${f.name}" target="_blank"
           class="bg-slate-800 hover:bg-slate-700 px-4 py-2 rounded-xl text-sm">
          â¬‡ï¸ Download
        </a>`;
      list.appendChild(div);
    });
  } catch {
    empty.classList.remove("hidden");
    empty.innerText = "Server offline.";
  }
}
</script>

</body>
</html>
